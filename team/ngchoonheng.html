<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.3">
<title>Ng Choon Heng - Project Portfolio</title>
<link rel="stylesheet" href="../stylesheets/gh-pages.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
<link rel="stylesheet" href="../stylesheets/coderay-asciidoctor.css">
</head>
<body class="article">
<div id="header">
<h1>Ng Choon Heng - Project Portfolio</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="project-addressbook-level-4"><a class="link" href="#project-addressbook-level-4">Project: AddressBook - Level 4</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>AddressBook - Level 4 is a desktop address book application used for teaching Software Engineering principles. The user interacts with it using a CLI, and it has a GUI created with JavaFX. It is written in Java, and has about 6 kLoC.</p>
</div>
<div class="paragraph">
<p><strong>Code contributed</strong>: [<a href="https://github.com/CS2103AUG2017-F10-B4/main/blob/master/collated/main/Choony93.md">Functional code</a>] [<a href="https://github.com/CS2103AUG2017-F10-B4/main/blob/master/collated/test/Choony93.md">Test code</a>]</p>
</div>
<div class="sect2">
<h3 id="enhancement-added-persistent-color-tags"><a class="link" href="#enhancement-added-persistent-color-tags">Enhancement Added: Persistent Color tags</a></h3>
<div class="sect3">
<h4 id="external-behavior"><a class="link" href="#external-behavior">External behavior</a></h4>
<hr>
<div class="paragraph">
<p><mark>Start of Extract [from: User Guide]</mark></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="static-code-colored-code-tags-v1-0"><a class="link" href="#static-code-colored-code-tags-v1-0">Static <code>colored</code> tags (v1.0)</a></h3>
<div class="paragraph">
<p><strong>Author</strong>: Ng Choon Heng</p>
</div>
<div class="paragraph">
<p>Tags generated will automatically be assigned a unique color.+
Similar tags will also be assigned the same color as long as tags have the same spelling.</p>
</div>
<div class="paragraph">
<p><mark>End of Extract</mark></p>
</div>
<hr>
<div class="sect3">
<h4 id="justification"><a class="link" href="#justification">Justification</a></h4>
<div class="paragraph">
<p>User tend to remember and identify colors easier than words. Ever-changing colored tags is not user friendly.</p>
</div>
</div>
<div class="sect3">
<h4 id="implementation"><a class="link" href="#implementation">Implementation</a></h4>
<hr>
<div class="paragraph">
<p><mark>Start of Extract [from: Developer Guide]</mark></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="persisting-coloured-tags"><a class="link" href="#persisting-coloured-tags">Persisting coloured tags</a></h3>
<div class="paragraph">
<p>Enhanced feature to allow unique coloured tags to persist after the program exits without having to save color data on external files.</p>
</div>
<div class="paragraph">
<p>Full Code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">String</span> getColorForTag(<span class="predefined-type">String</span> tagValue) {

        <span class="keyword">if</span> (!tagColors.containsKey(tagValue)) {
            <span class="type">int</span> multiplier = <span class="integer">1</span>;
            <span class="type">int</span> asciiSum = (tagValue.hashCode() &gt; <span class="integer">1</span>) ? tagValue.hashCode() : tagValue.hashCode() * -<span class="integer">1</span>;

            <span class="type">int</span> colorRed = asciiSum % <span class="integer">256</span>;
            <span class="type">int</span> colorGreen = (asciiSum / <span class="integer">2</span>) % <span class="integer">256</span>;
            <span class="type">int</span> colorBlue = (asciiSum / <span class="integer">3</span>) % <span class="integer">256</span>;
            <span class="keyword">while</span> ((colorRed + colorGreen + colorBlue) &gt; <span class="integer">700</span>) {
                asciiSum = (asciiSum / multiplier) * ++multiplier;
                colorRed = asciiSum % <span class="integer">256</span>;
                colorGreen = (asciiSum / <span class="integer">2</span>) % <span class="integer">256</span>;
                colorBlue = (asciiSum / <span class="integer">3</span>) % <span class="integer">256</span>;
            }
            <span class="predefined-type">String</span> colorString = <span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">#%02x%02x%02x</span><span class="delimiter">&quot;</span></span>, colorRed, colorGreen, colorBlue);
            tagColors.put(tagValue, colorString);
        }

        <span class="keyword">return</span> tagColors.get(tagValue);
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Java&#8217;s <code>hashcode()</code> method from <strong>String</strong> library will be used to obtain a unique 32-bit integer hash value of the tag String. We first obtain the hashcode and ensure it is a positive value.
Function <strong>getColorForTag(String tagValue)</strong> is supposedly implemented in the PersonCard class, as expected from suggestions on developer guide UI component.
(Note: Identical strings will result in the same hashcode value)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">int</span> asciiSum = (tagValue.hashCode() &gt; <span class="integer">1</span>) ? tagValue.hashCode() : tagValue.hashCode() * -<span class="integer">1</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We then do a separate division of each color and modulus it by <strong>256</strong> to ensure that it will stay within the RGB limit of 0 - 255.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">int</span> colorRed = asciiSum % <span class="integer">256</span>;
<span class="type">int</span> colorGreen = (asciiSum / <span class="integer">2</span>) % <span class="integer">256</span>;
<span class="type">int</span> colorBlue = (asciiSum / <span class="integer">3</span>) % <span class="integer">256</span>;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To ensure that colors stays within visible range, we do a check if sum of RGB is above 700. If it is, it is likely that the color generated is too bright and would not be visible with the white font, hence regenerate the color again.
We can use an incremental multiplier to regenerate another unique hashcode from the original hashcode. However, to prevent the numbers form getting exponentially large and exceeding the 32-bit sized integer, we shall first divide it by the previous multiplier.
It is save to assume that chances of collision with other hashcodes is extremely low since we are using extremely large numbers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">while</span> ((colorRed + colorGreen + colorBlue) &gt; <span class="integer">700</span>) {
                asciiSum = (asciiSum / multiplier) * ++multiplier;
                colorRed = asciiSum % <span class="integer">256</span>;
                colorGreen = (asciiSum / <span class="integer">2</span>) % <span class="integer">256</span>;
                colorBlue = (asciiSum / <span class="integer">3</span>) % <span class="integer">256</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, we format the RBG values into hexadecimal format with a hex symbol in front to conform with conventional CSS color styling before adding it into the color tag.</p>
</div>
<div class="sect3">
<h4 id="design-considerations"><a class="link" href="#design-considerations">Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Aspect:</strong> Generating of colors for <code>colorTag</code>.<br>
<strong>Alternative 1 (current choice):</strong> Generate unique color based on tag string.<br>
<strong>Pros:</strong> Unique tags will always have unique colors.<br>
<strong>Cons:</strong> Hard for new developers to understand the color code generation.<br>
<strong>Alternative 2:</strong> Create a static list of limited colors and randomly retrieve colors from there.<br>
<strong>Pros:</strong> Does not involve complex code generation, easier for new developers to understand.<br>
<strong>Cons:</strong> Tag colors renew whenever program restarts.</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Aspect:</strong> Saving colors retain color persistence after program shuts down.<br>
<strong>Alternative 1 (current choice):</strong> Morph in-built <code>hashcode()</code> function output to obtain RBG colors.<br>
<strong>Pros:</strong> Color persistence without the need to save color details onto offline files.<br>
<strong>Cons:</strong> Chances of certain tags resulting in generating very similar RGB colors.<br>
<strong>Alternative 2:</strong> Save chosen tag colors onto external file.<br>
<strong>Pros:</strong> Hard for new developers to understand how colors are retained.<br>
<strong>Cons:</strong> Must create additional file and include additional unnecessary codes for read/write.</p>
</div>
<div class="paragraph">
<p><mark>End of Extract</mark></p>
</div>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="enhancement-added-google-maps"><a class="link" href="#enhancement-added-google-maps">Enhancement Added: Google Maps</a></h3>
<div class="sect3">
<h4 id="external-behavior-2"><a class="link" href="#external-behavior-2">External behavior</a></h4>
<hr>
<div class="paragraph">
<p><mark>Start of Extract [from: User Guide]</mark></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="displaying-google-map-code-gmap-code-v1-2"><a class="link" href="#displaying-google-map-code-gmap-code-v1-2">Displaying google map : <code>gmap</code> (v1.2)</a></h3>
<div class="paragraph">
<p><strong>Author</strong>: Ng Choon Heng</p>
</div>
<div class="paragraph">
<p>Displays the google map of the person identified by the index number used in the last person listing.<br>
Format: <code>gmap INDEX</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Loads the peron&#8217;s address into Google map page at the specified <code>INDEX</code>.</p>
</li>
<li>
<p>The index refers to the index number shown in the most recent listing.</p>
</li>
<li>
<p>The index <strong>must be a positive integer</strong> <code>1, 2, 3, &#8230;&#8203;</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>list</code><br>
<code>gmap 2</code><br>
Display google map of the 2nd person in the address book.</p>
</li>
<li>
<p><code>find Betsy</code><br>
<code>gmap 1</code><br>
Display google map the 1st person in the results of the <code>find</code> command.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="gmap-command-accepts-person-name-v1-3"><a class="link" href="#gmap-command-accepts-person-name-v1-3">Gmap command accepts person name (v1.3)</a></h3>
<div class="paragraph">
<p><strong>Author</strong>: Ng Choon Heng</p>
</div>
<div class="paragraph">
<p>Gmap command can now accept person name instead of just Index only.</p>
</div>
<div class="paragraph">
<p>Displays the google map of the person identified by the name used in the last person listing.<br>
Format: <code>gmap NAME</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Loads the peron&#8217;s address into Google map page at the specified <code>NAME</code>.</p>
</li>
<li>
<p>The name reference is case-insensitive</p>
</li>
<li>
<p>The name <strong>must be a whole word</strong> such as <code>Bernice</code> and not <code>Bern</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>list</code><br>
<code>gmap Bernice</code><br>
Display google map of the person with name <strong>Bernice</strong> in the address book.</p>
</li>
<li>
<p><code>find Yu</code><br>
<code>gmap Yu</code><br>
Display google map of the person in the results of the <code>find</code> command with <strong>Yu</strong> surname.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><mark>End of Extract</mark></p>
</div>
<hr>
<div class="sect3">
<h4 id="justification-2"><a class="link" href="#justification-2">Justification</a></h4>
<div class="paragraph">
<p>Having just textual data of person&#8217;s address is not user friendly nor informative at all.</p>
</div>
</div>
<div class="sect3">
<h4 id="implementation-2"><a class="link" href="#implementation-2">Implementation</a></h4>
<hr>
<div class="paragraph">
<p><mark>Start of Extract [from: Developer Guide]</mark></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="google-map-mechanism"><a class="link" href="#google-map-mechanism">Google Map Mechanism</a></h3>
<div class="paragraph">
<p>The Google map mechanism resides in a <code>GmapCommand</code> which also inherits from the <code>Command</code> object.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/GmapClassDiagram.png" alt="width:100">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.6.0.1 : GmapCommand object class diagram</em></p>
</div>
<div class="paragraph">
<p>There are two ways the user can utilize the Google map feature, first by entering the command into CommandBox or selecting the <strong>Google Map</strong> option from the dropdown menu on each <code>PersonCard</code> panel.</p>
</div>
<div class="sect3">
<h4 id="method-1"><a class="link" href="#method-1">Method 1</a></h4>
<div class="paragraph">
<p>The <code>GmapCommand</code> object sequence diagram can be seen below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/GmapSequenceDiagram1.png" alt="GmapSequenceDiagram1" width="750">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.6.1.1 : GmapCommand parser sequence diagram</em></p>
</div>
<div class="paragraph">
<p>As we can see, <code>GmapCommand</code> object is created after input has been validated from the <code>AddressBookParser</code>.
After initialization, <code>GmapCommand</code> will post a <code>DisplayGmapEvent</code> event while returning a command success or command failed message in <strong>result</strong> and return it to the LogicManager for GUI display.
The <code>DisplayGmapEvent</code> object contains information regarding the index of person in the addressbook.
Address data of a person can then be retrieved later using this index.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/GmapSequenceDiagram2.png" alt="GmapSequenceDiagram2" width="750">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.6.1.2 : GmapCommand execution sequence diagram</em></p>
</div>
<div class="paragraph">
<p>Event handling of <code>DisplayGmapEvent</code> is done on the <code>BrowserPanel</code> that subsequently loads its <strong>loadMapPage()</strong> function.</p>
</div>
<div class="paragraph">
<p><code>GmapCommand</code> object has double constructor that takes in either index-based or a predicate containing names to be searched.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> GmapCommand(Index targetIndex) {
        <span class="local-variable">this</span>.usingIndex = <span class="predefined-constant">true</span>;
        <span class="local-variable">this</span>.targetIndex = targetIndex;
    }

<span class="directive">public</span> GmapCommand(NameConsistsKeywordsPredicate predicate) {
    <span class="local-variable">this</span>.usingIndex = <span class="predefined-constant">false</span>;
    <span class="local-variable">this</span>.predicate = predicate;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Command execution residing in <strong>execute()</strong> will then attempt to validate the given index if it exists or returning the first index of a list of persons that matches all the predicate that the user has indicated.</p>
</div>
<div class="paragraph">
<p>Finally, <strong>DisplayGmapEvent</strong> will be raised with this index in its parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">EventsCenter.getInstance().post(<span class="keyword">new</span> DisplayGmapEvent(targetIndex));</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="method-2"><a class="link" href="#method-2">Method 2</a></h4>
<div class="paragraph">
<p>The second way is to select the Google Map option under the dropdown list on the GUI. Each <code>PersonCard</code> has its own handler which will automatically raise a DisplayGmapEvent with the <code>PersonCard</code> index as parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> handleGoogleMap() {
    raise(<span class="keyword">new</span> DisplayGmapEvent(Index.fromOneBased(<span class="local-variable">this</span>.displayedIndex)));
}</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/GmapSequenceDiagram3.png" alt="GmapSequenceDiagram3" width="750">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.6.2.1 : GmapCommand GUI sequence diagram</em></p>
</div>
<div class="paragraph">
<p>Since the GUI already has index tagged on every PersonCardPanel, there is no need for input validation.
Hence, the event can be raised directly and be handled in the <code>BrowserPanel</code> similar to <strong>Method 1</strong>.</p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-2"><a class="link" href="#design-considerations-2">Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Aspect:</strong> Loading of Google Map data.<br>
<strong>Alternative 1 (current choice):</strong> Loading a modified URL into <code>WebView</code>.<br>
<strong>Pros:</strong> Much lesser codes needed, very easy for new developers to understand.<br>
<strong>Cons:</strong> Lacks flexibility in utilizing Google&#8217;s map feature.<br>
<strong>Alternative 2:</strong> Use Google&#8217;s Java client libraries.<br>
<strong>Pros:</strong> Allows much more flexibility and use directions, places and distance features.<br>
<strong>Cons:</strong> Currently do not need all these extra features. Integrating external libraries induces unnecessary overhead and is hard for new developers to understand the code.</p>
</div>
<div class="paragraph">
<p><mark>End of Extract</mark></p>
</div>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="enhancement-added-theme-changer"><a class="link" href="#enhancement-added-theme-changer">Enhancement Added: Theme Changer</a></h3>
<div class="sect3">
<h4 id="external-behavior-3"><a class="link" href="#external-behavior-3">External behavior</a></h4>
<hr>
<div class="paragraph">
<p><mark>Start of Extract [from: User Guide]</mark></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="themes-selection-from-code-file-code-toolbar-v1-2"><a class="link" href="#themes-selection-from-code-file-code-toolbar-v1-2">Themes selection from <code>File</code> toolbar (v1.2)</a></h3>
<div class="paragraph">
<p><strong>Author</strong>: Ng Choon Heng</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/theme_selection.png" alt="theme selection" width="300">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.8.1 : Using Theme selection from Menu toolbar</em></p>
</div>
<div class="paragraph">
<p>Allows user to select from a range of user interface themes<br>
Function will be found from under the <code>File</code> section of menu toolbar.<br>
Selected themes will be saved into user preference file upon exit of program.<br>
Reinitializing of myBook will display the previous choice of theme.</p>
</div>
</div>
<div class="sect2">
<h3 id="changing-theme-with-cli-command-v1-3"><a class="link" href="#changing-theme-with-cli-command-v1-3">Changing theme with CLI command (v1.3)</a></h3>
<div class="paragraph">
<p><strong>Author</strong>: Ng Choon Heng</p>
</div>
<div class="paragraph">
<p>Theme command can now accept both theme NAME and INDEX.</p>
</div>
<div class="paragraph">
<p>Changes the theme of the main window with specified name or index.<br>
Format: <code>theme NAME</code><br>
Format: <code>theme INDEX</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Loads the theme based on <code>NAME</code> or <code>INDEX</code>.</p>
</li>
<li>
<p>The name reference is case-insensitive.</p>
</li>
<li>
<p>The name <strong>must be a whole word</strong> such as <code>darktheme</code> and not <code>dark</code>.</p>
</li>
<li>
<p>The index must be a positive integer.</p>
</li>
<li>
<p>Input command <code>theme</code> will display a current list of available themes.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>Available Themes:</strong><br>
[INDEX]. [NAME]<br>
1. DarkTheme<br>
2. Bootstrap3<br>
3. Caspian<br>
4. Modena<br>
5. (Modena) BlackOnWhite<br>
6. (Modena) WhiteOnBlack<br>
7. (Modena) YellowOnBlack<br></p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p><code>theme caspian</code><br>
Changes the addressbook theme to <strong>Caspian</strong> theme.<br>
<code>theme 1</code><br>
Changes the addressbook theme to theme <code>INDEX</code> of one, which is default <strong>DarkTheme</strong>.</p>
</div>
<div class="paragraph">
<p><mark>End of Extract</mark></p>
</div>
<hr>
<div class="sect3">
<h4 id="justification-3"><a class="link" href="#justification-3">Justification</a></h4>
<div class="paragraph">
<p>Having multiple themes to suit the user needs improves overall user experience, especially for younger target audience.</p>
</div>
</div>
<div class="sect3">
<h4 id="implementation-3"><a class="link" href="#implementation-3">Implementation</a></h4>
<hr>
<div class="paragraph">
<p><mark>Start of Extract [from: Developer Guide]</mark></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="theme-changer-mechanism"><a class="link" href="#theme-changer-mechanism">Theme Changer Mechanism</a></h3>
<div class="paragraph">
<p>This feature can be used from both the CLI and GUI.
Similar to the Google Map mechanism, the <code>ThemeCommand</code> object created when using the CLI is also a subclass of <code>Command</code> object.</p>
</div>
<div class="paragraph">
<p><strong>Refer to Figure 3.6.0.1</strong></p>
</div>
<div class="sect3">
<h4 id="method-1-2"><a class="link" href="#method-1-2">Method 1</a></h4>
<div class="paragraph">
<p>The creation of <code>ThemeCommand</code> object is also similar to most <code>Command</code> classes.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/ThemeSequenceDiagram1.png" alt="ThemeSequenceDiagram1" width="750">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.7.1.1 : ThemeCommand parser sequence diagram</em></p>
</div>
<div class="paragraph">
<p><code>ThemeCommand</code> is created after <code>AddressBookParser</code> validation is successful.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/ThemeSequenceDiagram2.png" alt="ThemeSequenceDiagram2" width="750">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.7.1.2 : ThemeCommand execution sequence diagram</em></p>
</div>
<div class="paragraph">
<p>Validation within the <strong>execute()</strong> function will check for valid theme index or name.
Once this validation is successful, a <code>ChangeThemeEvent</code> event will be raised to <code>EventsCenter</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Override</span>
<span class="directive">public</span> CommandResult execute() <span class="directive">throws</span> CommandException {

    <span class="comment">// Theme name or index validation code</span>

    EventsCenter.getInstance().post(<span class="keyword">new</span> ChangeThemeEvent(targetIndex));
    <span class="keyword">return</span> <span class="keyword">new</span> CommandResult(<span class="predefined-type">String</span>.format(MESSAGE_THEME_CHANGE_SUCCESS,
                UiPart.getThemeNameByIndex(<span class="local-variable">this</span>.targetIndex.getZeroBased())));

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Event handling will then be done at <code>MainWindow</code> object class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="type">void</span> handleChangeThemeEvent(ChangeThemeEvent event) {
    logger.info(LogsCenter.getEventHandlingLogMessage(event));
    setTheme(THEME_FILE_FOLDER + THEME_LIST_DIR.get(event.targetIndex));
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="method-2-2"><a class="link" href="#method-2-2">Method 2</a></h4>
<div class="paragraph">
<p>The second method of utilizing the theme feature is from the GUI. Each buttons from the menu toolbar is tied to its own theme url.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@FXML</span>
<span class="directive">public</span> <span class="type">void</span> handleThemeModenaYoB() {
    setTheme(THEME_FILE_FOLDER + THEME_CSS_MODENA_YELLOWONBLACK);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The handling of theme buttons from Menu toolbar directly calls the <strong>setTheme()</strong> function.</p>
</div>
</div>
<div class="sect3">
<h4 id="updating-default-page"><a class="link" href="#updating-default-page">Updating default page</a></h4>
<div class="paragraph">
<p>The initial default web page displayed in <code>BrowserPanel</code> is a blank <strong>default.html</strong> page that uses a static darktheme CSS file for its styles.
Changing of styles using Java 8 API by adding external stylesheet only changes the GUI for Java 8&#8217;s components.
The CSS styles for <strong>default.html</strong> will continue to reflect darktheme styles.</p>
</div>
<div class="paragraph">
<p>Hence, <strong>default.html</strong> file was modified to allow reading of parameters to indicate which themes are currently used, and update its local CSS file accordingly.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="tag">&lt;script</span> <span class="attribute-name">language</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">javascript</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
<span class="comment">
    &lt;!--</span><span class="inline"> Code to retrieve theme css URI from parameters </span><span class="comment">--&gt;</span>

    <span class="comment">&lt;!-- On page load, extract selected theme from parameter in the URL and edit respective css file --&gt;</span>
                window.onload = function(e){
                        var theme  = getParameterByName('theme');
                        if (theme) {
                                var oldlink = document.getElementsByTagName(&quot;link&quot;).item(0);
                                var newlink = document.createElement(&quot;link&quot;);

                                newlink.setAttribute(&quot;rel&quot;, &quot;stylesheet&quot;);
                                newlink.setAttribute(&quot;type&quot;, &quot;text/css&quot;);
                                newlink.setAttribute(&quot;href&quot;, theme);

                                document.getElementsByTagName(&quot;head&quot;).item(0).replaceChild(newlink, oldlink);
                        }
                }
<span class="tag">&lt;/script&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With this in place, whenever there&#8217;s a change of themes, the <strong>default.html</strong> page will be reloaded with theme information supplied in its URL parameters.</p>
</div>
<div class="paragraph">
<p><strong>Disclaimer:</strong><br>
Stylesheets and images of available themes were obtained online with slight modification of the CSS file.</p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-3"><a class="link" href="#design-considerations-3">Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Aspect:</strong> Storing of stylesheets.<br>
<strong>Alternative 1 (current choice):</strong> Storing multiple CSS files offline and read on demand.<br>
<strong>Pros:</strong> Easier to modify stylesheets and for new developer to understand.<br>
<strong>Cons:</strong> Additional offline files to be stored.<br>
<strong>Alternative 2:</strong> Creating a static set of styles in java itself.<br>
<strong>Pros:</strong> Does not require additional offline files. <br>
<strong>Cons:</strong> Harder to edit styles. Codes get more complicated and harder to understand, especially when there&#8217;s alot of CSS rules.</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Aspect:</strong> Updating of default web page styles.<br>
<strong>Alternative 1 (current choice):</strong> Indicating theme data with default web page parameters.<br>
<strong>Pros:</strong> Can dynamically set web page css file to be accordance to current Java theme.<br>
<strong>Cons:</strong> Harder for new developers to understand. Requires understanding of Javascript.<br>
<strong>Alternative 2:</strong> Switching default web page to be transparent.<br>
<strong>Pros:</strong> Much easier for new developers to understand. <br>
<strong>Cons:</strong> Default web page will be made obsolete. Unable to utilize it for other improvements and features in the future.</p>
</div>
<div class="paragraph">
<p><mark>End of Extract</mark></p>
</div>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="enhancement-added-import-addressbook"><a class="link" href="#enhancement-added-import-addressbook">Enhancement Added: Import Addressbook</a></h3>
<div class="sect3">
<h4 id="external-behavior-4"><a class="link" href="#external-behavior-4">External behavior</a></h4>
<hr>
<div class="paragraph">
<p><mark>Start of Extract [from: User Guide]</mark></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="import-xml-addressbook-command-v1-4"><a class="link" href="#import-xml-addressbook-command-v1-4">Import XML addressbook command (v1.4)</a></h3>
<div class="paragraph">
<p><strong>Author</strong>: Ng Choon Heng</p>
</div>
<div class="paragraph">
<p>External addressbook can now be imported using <code>import</code> command</p>
</div>
<div class="paragraph">
<p>Appends current addreessbook persons with given URL.<br>
Format: <code>import [ABSOULTE_PATH]</code><br>
Format: <code>import [RELATIVE_PATH]</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Loads the XML addressbook file from given path.</p>
</li>
<li>
<p>If person name from new addressbook does not exist, add into local addressbook.</p>
</li>
<li>
<p>If person name from new addressbook already exist, update into local addressbook.</p>
</li>
<li>
<p>The XML file from given path <strong>must exist</strong>.</p>
</li>
<li>
<p>The XML file from given path must be <strong>well-formed</strong>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p><code>import C:\Users\Test\newAddressbook.xml</code><br>
Add new persons from newAddressBook into local addressbook.<br>
<code>import data\addressbok2.xml</code><br>
Add new persons from addressbook2 from local project<br>
folder <strong>data</strong> into local addressbook.</p>
</div>
</div>
<div class="sect2">
<h3 id="import-feature-from-code-file-code-toolbar-v1-5"><a class="link" href="#import-feature-from-code-file-code-toolbar-v1-5">Import feature from <code>File</code> toolbar (v1.5)</a></h3>
<div class="imageblock">
<div class="content">
<img src="../images/import_selection.png" alt="import selection" width="250">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.19.1 : Using import feature from Menu toolbar</em></p>
</div>
<div class="paragraph">
<p>Users can now import external addressbooks from the GUI. Clicking on the <code>Import Addressbook</code> button will pop up a File Chooser dialog to allow users to choose the addressbook file. File Chooser dailog has been set to restrict <strong>.xml</strong> extention files only.</p>
</div>
<div class="paragraph">
<p><mark>End of Extract</mark></p>
</div>
<hr>
<div class="sect3">
<h4 id="justification-4"><a class="link" href="#justification-4">Justification</a></h4>
<div class="paragraph">
<p>Adds convenience for users to import persons from external addressbooks instead of having to add them manually one by one.</p>
</div>
</div>
<div class="sect3">
<h4 id="implementation-4"><a class="link" href="#implementation-4">Implementation</a></h4>
<hr>
<div class="paragraph">
<p><mark>Start of Extract [from: Developer Guide]</mark></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="import-mechanism"><a class="link" href="#import-mechanism">Import Mechanism</a></h3>
<div class="paragraph">
<p>Just like the Google Map and Theme Changing feature, the <strong>Import</strong> feature can also be used from both the CLI and GUI.
Similarly, <code>ImportCommand</code> object is also a subclass of the <code>Command</code> object.</p>
</div>
<div class="paragraph">
<p><strong>Refer to Figure 3.6.0.1</strong></p>
</div>
<div class="sect3">
<h4 id="method-1-3"><a class="link" href="#method-1-3">Method 1</a></h4>
<div class="paragraph">
<p>Import feature can first be utilized using the CLI. The sequence diagram for parsing of import command input is also similar to <strong>Theme Changer Mechanism</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Refer to Figure 3.7.1.1</strong></p>
</div>
<div class="paragraph">
<p>Upon command execution after <code>ImportCommand</code> has been initialized, <code>AddressBookImportEvent</code> will be raised to the <code>EventsCenter</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/ImportSequenceDiagram1.png" alt="ImportSequenceDiagram1" width="750">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.8.1.1 : Import CLI execution sequence diagram</em></p>
</div>
<div class="paragraph">
<p>Event handling will then be done at the <code>Model</code> component by the <code>ModelManager</code>.
It will first process all records of person in the new addressbook. If the person name does not exist, it will add that person into the local addressbook.
If the person name already exist, it will check if both old and new person&#8217;s details are identical. If it is not, it will update the local copy with the new one.</p>
</div>
</div>
<div class="sect3">
<h4 id="method-2-3"><a class="link" href="#method-2-3">Method 2</a></h4>
<div class="paragraph">
<p>Import command can also be accessed from the Menu toolbar.</p>
</div>
<div class="paragraph">
<p><strong>Refer to UserGuide 3.9</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/ImportSequenceDiagram2.png" alt="ImportSequenceDiagram2" width="750">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.8.1.1 : Import Feature GUI sequence diagram</em></p>
</div>
<div class="paragraph">
<p>Java 8&#8217;s FileChooser object is used to retrieve File URI from user.
File path validation will be done within the <code>MainWindow</code> when <strong>handleImport()</strong> is triggered.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> handleImport() {
    <span class="keyword">try</span> {
        <span class="comment">// Attempt to read XML file</span>
        addressBookOptional = XmlFileStorage.loadDataFromSaveFile(<span class="keyword">new</span> <span class="predefined-type">File</span>(selectedFile.getPath()));
        raise(<span class="keyword">new</span> AddressBookImportEvent(selectedFile.getPath(), addressBookOptional));

        <span class="comment">// Raise success message back to UI</span>
        cmdResult = <span class="keyword">new</span> CommandResult(<span class="predefined-type">String</span>.format(MESSAGE_IMPORT_SUCCESS, selectedFile.getPath()));
        raise(<span class="keyword">new</span> NewResultAvailableEvent(cmdResult.feedbackToUser, <span class="predefined-constant">true</span>));

    } <span class="keyword">catch</span> (DataConversionException e) { <span class="comment">// Catch not well-formed XML files</span>
        cmdResult = <span class="keyword">new</span> CommandResult(<span class="predefined-type">String</span>.format(MESSAGE_INVALID_XML_FORMAT_ERROR, selectedFile.getPath()));
        raise(<span class="keyword">new</span> NewResultAvailableEvent(cmdResult.feedbackToUser, <span class="predefined-constant">true</span>));

    } <span class="keyword">catch</span> (<span class="exception">IOException</span> e) { <span class="comment">// Catch missing files</span>
        cmdResult = <span class="keyword">new</span> CommandResult(<span class="predefined-type">String</span>.format(MESSAGE_INVALID_IMPORT_FILE_ERROR, selectedFile.getPath()));
        raise(<span class="keyword">new</span> NewResultAvailableEvent(cmdResult.feedbackToUser, <span class="predefined-constant">true</span>));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To validate the xml file, it will first attempt to read its content.
Non well-formed documents or file not found will be caught similar to <strong>Method 1</strong>.
Results will then be created <code>CommandResult</code> and be wrapped with <code>NewResultAvailableEvent</code> objects before being raised.</p>
</div>
<div class="paragraph">
<p><code>NewResultAvailableEvent</code> will then be returned to <code>ResultDiplay</code> class for GUI update of action outcome.</p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-4"><a class="link" href="#design-considerations-4">Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Aspect:</strong> Modes of import.<br>
<strong>Alternative 1 (current choice):</strong> Append new person and update existing ones.<br>
<strong>Pros:</strong> Gives flexibility replacing entire addressbook or appending existing addressbook.<br>
<strong>Cons:</strong> Codes slightly more complex.<br>
<strong>Alternative 2:</strong> Replace entire addressbook with new one.<br>
<strong>Pros:</strong> Codes are more simple and easier for new developer to understand. <br>
<strong>Cons:</strong> Does not give the user option to append or replace existing addressbook.</p>
</div>
<div class="paragraph">
<p><mark>End of Extract</mark></p>
</div>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="other-contributions"><a class="link" href="#other-contributions">Other contributions</a></h3>
<div class="ulist">
<ul>
<li>
<p>Set up Project environment for Travis, Appveyor and Coveralls</p>
</li>
<li>
<p>Creating and assigning most of the repository labels and milestones.</p>
</li>
<li>
<p>Issuing the project version release.</p>
</li>
<li>
<p>Provided suggestions and advices for external teams (
<a href="https://github.com/CS2103AUG2017-F11-B1/main/issues/90">#90</a>,
<a href="https://github.com/CS2103AUG2017-F11-B1/main/issues/89">#89</a>,
<a href="https://github.com/CS2103AUG2017-F11-B1/main/issues/88">#88</a>).</p>
</li>
<li>
<p>Uploaded code reuse offer for persistent color tags on git forum
<a href="https://github.com/nus-cs2103-AY1718S1/forum/issues/199">#199</a>.</p>
</li>
<li>
<p>Persistent color tags reused by
<a href="https://github.com/CS2103AUG2017-F11-B3/main/pull/79">F11-B3</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-11-12 12:49:16 +00:00
</div>
</div>
</body>
</html>